<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>QR Code Dashboard - Preview</title>
  <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://unpkg.com/qrcode.react@3.1.0/lib/index.js"></script>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    :root {
      --primary-color: #4F46E5;
      --primary-hover: #4338CA;
      --primary-light: #EEF2FF;
      --gray-50: #F9FAFB;
      --gray-100: #F3F4F6;
      --gray-200: #E5E7EB;
      --gray-300: #D1D5DB;
      --gray-400: #9CA3AF;
      --gray-500: #6B7280;
      --gray-600: #4B5563;
      --gray-700: #374151;
      --gray-800: #1F2937;
      --gray-900: #111827;
      --success-color: #10B981;
      --success-bg: #D1FAE5;
      --error-color: #EF4444;
      --error-bg: #FEE2E2;
      --warning-color: #F59E0B;
      --warning-bg: #FEF3C7;
      --info-color: #3B82F6;
      --info-bg: #DBEAFE;
      --spacing-xs: 4px;
      --spacing-sm: 8px;
      --spacing-md: 16px;
      --spacing-lg: 24px;
      --spacing-xl: 32px;
      --spacing-2xl: 48px;
      --radius-sm: 4px;
      --radius-md: 8px;
      --radius-lg: 12px;
      --radius-xl: 16px;
      --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
      --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
      --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
      --transition-fast: 150ms ease;
      --transition-normal: 200ms ease;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      font-size: 14px;
      line-height: 1.5;
      color: var(--gray-800);
      background-color: var(--gray-100);
      padding: 24px;
    }

    .btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      padding: 8px 16px;
      font-size: 14px;
      font-weight: 500;
      border-radius: 8px;
      border: none;
      cursor: pointer;
      transition: all 150ms ease;
    }

    .btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }

    .btn-primary {
      background-color: var(--primary-color);
      color: white;
    }

    .btn-primary:hover:not(:disabled) {
      background-color: var(--primary-hover);
    }

    .btn-secondary {
      background-color: var(--gray-100);
      color: var(--gray-700);
    }

    .btn-secondary:hover:not(:disabled) {
      background-color: var(--gray-200);
    }

    .btn-outline {
      background-color: transparent;
      color: var(--gray-700);
      border: 1px solid var(--gray-300);
    }

    .btn-outline:hover:not(:disabled) {
      background-color: var(--gray-100);
    }

    .btn-icon {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      width: 36px;
      height: 36px;
      padding: 0;
      background: transparent;
      border: none;
      border-radius: 8px;
      color: var(--gray-500);
      cursor: pointer;
    }

    .btn-icon:hover {
      background-color: var(--gray-100);
      color: var(--gray-700);
    }

    input, textarea, select {
      width: 100%;
      padding: 8px 16px;
      font-size: 14px;
      border: 1px solid var(--gray-300);
      border-radius: 8px;
      background-color: white;
    }

    input:focus, textarea:focus, select:focus {
      outline: none;
      border-color: var(--primary-color);
      box-shadow: 0 0 0 3px var(--primary-light);
    }

    label {
      display: block;
      margin-bottom: 4px;
      font-weight: 500;
      color: var(--gray-700);
    }

    /* Dashboard Styles */
    .qr-dashboard {
      max-width: 1200px;
      margin: 0 auto;
      background-color: white;
      border-radius: 16px;
      box-shadow: var(--shadow-lg);
      overflow: hidden;
    }

    .dashboard-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 24px 32px;
      border-bottom: 1px solid var(--gray-200);
    }

    .header-left {
      display: flex;
      align-items: center;
      gap: 16px;
    }

    .dashboard-title {
      font-size: 24px;
      font-weight: 600;
      color: var(--gray-900);
    }

    .qr-count {
      padding: 4px 8px;
      font-size: 12px;
      font-weight: 500;
      color: var(--gray-600);
      background-color: var(--gray-100);
      border-radius: 8px;
    }

    .header-right {
      display: flex;
      align-items: center;
      gap: 16px;
    }

    .selected-count {
      font-size: 13px;
      font-weight: 500;
      color: var(--primary-color);
    }

    .dashboard-actions {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 16px 32px;
      background-color: var(--gray-50);
      border-bottom: 1px solid var(--gray-200);
    }

    .actions-left, .actions-right {
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .dashboard-content {
      padding: 32px;
      min-height: 400px;
    }

    /* Grid Styles */
    .qr-grid {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 24px;
    }

    @media (max-width: 1024px) {
      .qr-grid { grid-template-columns: repeat(3, 1fr); }
    }

    @media (max-width: 768px) {
      .qr-grid { grid-template-columns: repeat(2, 1fr); }
      .dashboard-actions { flex-direction: column; gap: 16px; }
      .actions-left, .actions-right { width: 100%; justify-content: center; flex-wrap: wrap; }
    }

    @media (max-width: 480px) {
      .qr-grid { grid-template-columns: 1fr; }
    }

    .qr-card {
      position: relative;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 24px;
      background-color: white;
      border: 2px solid var(--gray-200);
      border-radius: 12px;
      transition: all 200ms ease;
    }

    .qr-card:hover {
      border-color: var(--gray-300);
      box-shadow: var(--shadow-md);
    }

    .qr-card.selected {
      border-color: var(--primary-color);
      background-color: var(--primary-light);
    }

    .qr-select {
      position: absolute;
      top: 8px;
      left: 8px;
      cursor: pointer;
    }

    .checkbox {
      width: 20px;
      height: 20px;
      display: flex;
      align-items: center;
      justify-content: center;
      border: 2px solid var(--gray-300);
      border-radius: 4px;
      background-color: white;
    }

    .checkbox.checked {
      background-color: var(--primary-color);
      border-color: var(--primary-color);
      color: white;
    }

    .qr-image {
      cursor: pointer;
      padding: 8px;
      background-color: white;
      border-radius: 8px;
    }

    .qr-info {
      text-align: center;
      margin-top: 8px;
    }

    .qr-title {
      font-size: 14px;
      font-weight: 600;
      color: var(--gray-800);
      margin: 0 0 4px 0;
    }

    .qr-usecase {
      font-size: 12px;
      color: var(--gray-500);
    }

    .qr-actions {
      display: flex;
      gap: 4px;
      margin-top: 16px;
      opacity: 0;
      transition: opacity 150ms ease;
    }

    .qr-card:hover .qr-actions {
      opacity: 1;
    }

    .btn-edit:hover { color: var(--primary-color); background-color: var(--primary-light); }
    .btn-delete:hover { color: var(--error-color); background-color: var(--error-bg); }

    .qr-card-add {
      border-style: dashed;
      cursor: pointer;
      min-height: 220px;
      justify-content: center;
    }

    .qr-card-add:hover {
      border-color: var(--primary-color);
      background-color: var(--primary-light);
    }

    .add-icon { color: var(--gray-400); }
    .qr-card-add:hover .add-icon { color: var(--primary-color); }
    .qr-card-add span { margin-top: 8px; font-size: 14px; font-weight: 500; color: var(--gray-500); }
    .qr-card-add:hover span { color: var(--primary-color); }

    /* Empty State */
    .qr-grid-empty {
      display: flex;
      align-items: center;
      justify-content: center;
      min-height: 400px;
    }

    .empty-state {
      text-align: center;
      padding: 48px;
    }

    .empty-icon { color: var(--gray-300); margin-bottom: 24px; }
    .empty-state h3 { font-size: 18px; font-weight: 600; color: var(--gray-700); margin-bottom: 8px; }
    .empty-state p { font-size: 14px; color: var(--gray-500); margin-bottom: 24px; }

    /* Form Styles */
    .qr-form-container { max-width: 900px; margin: 0 auto; }
    .qr-form-header { margin-bottom: 32px; }
    .qr-form-header h2 { font-size: 24px; font-weight: 600; color: var(--gray-900); margin-bottom: 4px; }
    .qr-form-header p { font-size: 14px; color: var(--gray-500); }

    .form-layout {
      display: grid;
      grid-template-columns: 1fr 280px;
      gap: 32px;
      margin-bottom: 32px;
    }

    @media (max-width: 768px) {
      .form-layout { grid-template-columns: 1fr; }
      .qr-preview { order: -1; }
    }

    .form-fields { display: flex; flex-direction: column; gap: 24px; }
    .form-group { display: flex; flex-direction: column; }
    .form-group label { margin-bottom: 8px; }
    .form-group textarea { resize: vertical; min-height: 100px; }

    .input-footer { display: flex; justify-content: space-between; align-items: center; margin-top: 4px; }
    .char-count { font-size: 12px; color: var(--gray-400); }
    .error-message { font-size: 12px; color: var(--error-color); }

    .usecase-description {
      display: flex;
      align-items: flex-start;
      gap: 8px;
      padding: 16px;
      background-color: var(--info-bg);
      border-radius: 8px;
      color: var(--info-color);
    }

    .usecase-description svg { flex-shrink: 0; margin-top: 2px; }
    .usecase-description span { font-size: 13px; line-height: 1.5; }

    .qr-preview { display: flex; flex-direction: column; align-items: center; }
    .preview-label { font-size: 14px; font-weight: 500; color: var(--gray-700); margin-bottom: 8px; }

    .preview-box {
      display: flex;
      align-items: center;
      justify-content: center;
      width: 220px;
      height: 220px;
      background-color: var(--gray-50);
      border: 2px dashed var(--gray-300);
      border-radius: 12px;
    }

    .preview-placeholder {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 8px;
      color: var(--gray-400);
    }

    .preview-placeholder span { font-size: 12px; text-align: center; }
    .preview-title { margin-top: 16px; font-size: 14px; font-weight: 600; color: var(--gray-800); text-align: center; max-width: 220px; }

    .form-actions {
      display: flex;
      justify-content: flex-end;
      gap: 16px;
      padding-top: 24px;
      border-top: 1px solid var(--gray-200);
    }

    /* Print Preview */
    .print-preview { max-width: 900px; margin: 0 auto; }
    .preview-header { margin-bottom: 32px; }
    .preview-header h2 { font-size: 24px; font-weight: 600; color: var(--gray-900); margin-bottom: 4px; }
    .preview-header p { font-size: 14px; color: var(--gray-500); }

    .print-content {
      background-color: white;
      border: 1px solid var(--gray-200);
      border-radius: 12px;
      padding: 32px;
    }

    .print-header {
      text-align: center;
      margin-bottom: 32px;
      padding-bottom: 24px;
      border-bottom: 2px solid var(--gray-200);
    }

    .print-header h1 { font-size: 28px; font-weight: 600; color: var(--gray-900); margin-bottom: 4px; }
    .print-header p { font-size: 14px; color: var(--gray-500); }

    .print-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 32px;
    }

    @media (max-width: 768px) {
      .print-grid { grid-template-columns: repeat(2, 1fr); }
    }

    .print-qr-card {
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 24px;
      border: 1px solid var(--gray-200);
      border-radius: 8px;
      background-color: var(--gray-50);
    }

    .print-qr-image {
      background-color: white;
      padding: 8px;
      border-radius: 8px;
      box-shadow: var(--shadow-sm);
    }

    .print-qr-info { text-align: center; margin-top: 16px; }
    .print-qr-info h3 { font-size: 14px; font-weight: 600; color: var(--gray-800); margin-bottom: 4px; }
    .print-usecase { font-size: 12px; color: var(--gray-500); }

    .print-footer {
      text-align: center;
      margin-top: 32px;
      padding-top: 24px;
      border-top: 1px solid var(--gray-200);
    }

    .print-footer p { font-size: 12px; color: var(--gray-400); }

    .preview-actions {
      display: flex;
      justify-content: center;
      gap: 16px;
      margin-top: 32px;
    }

    /* Toast */
    .toast-container {
      position: fixed;
      top: 24px;
      right: 24px;
      z-index: 1000;
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .toast {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 16px;
      background-color: white;
      border-radius: 8px;
      box-shadow: var(--shadow-lg);
      min-width: 280px;
      max-width: 400px;
      animation: slideIn 0.3s ease;
    }

    @keyframes slideIn {
      from { transform: translateX(100%); opacity: 0; }
      to { transform: translateX(0); opacity: 1; }
    }

    .toast-icon { flex-shrink: 0; }
    .toast-message { flex: 1; font-size: 14px; color: var(--gray-700); }

    .toast-close {
      flex-shrink: 0;
      width: 24px;
      height: 24px;
      background: transparent;
      border: none;
      border-radius: 4px;
      color: var(--gray-400);
      cursor: pointer;
    }

    .toast-close:hover { background-color: var(--gray-100); color: var(--gray-600); }
    .toast-success { border-left: 4px solid var(--success-color); }
    .toast-success .toast-icon { color: var(--success-color); }
    .toast-error { border-left: 4px solid var(--error-color); }
    .toast-error .toast-icon { color: var(--error-color); }
    .toast-warning { border-left: 4px solid var(--warning-color); }
    .toast-warning .toast-icon { color: var(--warning-color); }
    .toast-info { border-left: 4px solid var(--info-color); }
    .toast-info .toast-icon { color: var(--info-color); }

    /* Print styles */
    @media print {
      body { padding: 0; background: white; }
      .qr-dashboard { box-shadow: none; }
      .dashboard-header, .dashboard-actions, .preview-header, .preview-actions { display: none; }
      .dashboard-content { padding: 20mm; }
      .print-content { border: none; }
      .print-grid { grid-template-columns: repeat(2, 1fr); gap: 15mm; }
      .print-qr-card { break-inside: avoid; }
    }
  </style>
</head>
<body>
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useCallback, useRef } = React;

    // Simple QR Code component using canvas
    function QRCodeCanvas({ value, size = 120 }) {
      const canvasRef = useRef(null);

      React.useEffect(() => {
        if (canvasRef.current && value) {
          // Use a simple QR code library loaded via CDN
          const canvas = canvasRef.current;
          const ctx = canvas.getContext('2d');

          // Clear canvas
          ctx.fillStyle = '#ffffff';
          ctx.fillRect(0, 0, size, size);

          // Generate simple QR pattern (placeholder - in production use proper QR library)
          const moduleSize = Math.floor(size / 25);
          const data = generateQRData(value);

          ctx.fillStyle = '#000000';
          for (let row = 0; row < 25; row++) {
            for (let col = 0; col < 25; col++) {
              if (data[row * 25 + col]) {
                ctx.fillRect(col * moduleSize, row * moduleSize, moduleSize, moduleSize);
              }
            }
          }
        }
      }, [value, size]);

      // Simple hash-based pattern generator (visual placeholder)
      function generateQRData(text) {
        const data = new Array(625).fill(false);

        // Position detection patterns (corners)
        const drawFinderPattern = (startX, startY) => {
          for (let i = 0; i < 7; i++) {
            for (let j = 0; j < 7; j++) {
              const isOuter = i === 0 || i === 6 || j === 0 || j === 6;
              const isInner = i >= 2 && i <= 4 && j >= 2 && j <= 4;
              if (isOuter || isInner) {
                data[(startY + i) * 25 + (startX + j)] = true;
              }
            }
          }
        };

        drawFinderPattern(0, 0);
        drawFinderPattern(18, 0);
        drawFinderPattern(0, 18);

        // Generate data pattern based on text hash
        let hash = 0;
        for (let i = 0; i < text.length; i++) {
          hash = ((hash << 5) - hash) + text.charCodeAt(i);
          hash = hash & hash;
        }

        for (let i = 8; i < 17; i++) {
          for (let j = 8; j < 17; j++) {
            const idx = i * 25 + j;
            data[idx] = ((hash >> ((i + j) % 32)) & 1) === 1;
          }
        }

        // Timing patterns
        for (let i = 8; i < 17; i++) {
          data[6 * 25 + i] = i % 2 === 0;
          data[i * 25 + 6] = i % 2 === 0;
        }

        return data;
      }

      return (
        <canvas
          ref={canvasRef}
          width={size}
          height={size}
          style={{ display: 'block' }}
        />
      );
    }

    // Icons
    const Icons = {
      close: <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>,
      plus: <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg>,
      back: <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><line x1="19" y1="12" x2="5" y2="12"></line><polyline points="12 19 5 12 12 5"></polyline></svg>,
      eye: <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path><circle cx="12" cy="12" r="3"></circle></svg>,
      print: <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polyline points="6 9 6 2 18 2 18 9"></polyline><path d="M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2"></path><rect x="6" y="14" width="12" height="8"></rect></svg>,
      edit: <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path></svg>,
      delete: <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polyline points="3 6 5 6 21 6"></polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path><line x1="10" y1="11" x2="10" y2="17"></line><line x1="14" y1="11" x2="14" y2="17"></line></svg>,
      check: <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="3" strokeLinecap="round" strokeLinejoin="round"><polyline points="20 6 9 17 4 12"></polyline></svg>,
      qrcode: <svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="1.5" strokeLinecap="round" strokeLinejoin="round"><rect x="3" y="3" width="7" height="7"></rect><rect x="14" y="3" width="7" height="7"></rect><rect x="14" y="14" width="7" height="7"></rect><rect x="3" y="14" width="7" height="7"></rect></svg>,
      info: <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="16" x2="12" y2="12"></line><line x1="12" y1="8" x2="12.01" y2="8"></line></svg>,
      success: <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path><polyline points="22 4 12 14.01 9 11.01"></polyline></svg>,
      warning: <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path><line x1="12" y1="9" x2="12" y2="13"></line><line x1="12" y1="17" x2="12.01" y2="17"></line></svg>,
    };

    // Use cases
    const useCases = [
      { id: 'uc-001', name: 'WiFi Connection', description: 'Share WiFi credentials with guests. QR code will auto-connect their device.' },
      { id: 'uc-002', name: 'House Rules', description: 'Link to property rules and guidelines guests should follow.' },
      { id: 'uc-003', name: 'Emergency Info', description: 'Quick access to emergency contacts and local services.' },
      { id: 'uc-004', name: 'Check-in Instructions', description: 'Step-by-step guide for guest check-in process.' },
      { id: 'uc-005', name: 'Local Recommendations', description: 'Curated list of nearby restaurants, attractions, and services.' },
      { id: 'uc-006', name: 'Appliance Guide', description: 'Instructions for using specific appliances in the property.' },
      { id: 'uc-007', name: 'Parking Instructions', description: 'Parking location and access instructions.' },
      { id: 'uc-008', name: 'Checkout Checklist', description: 'Tasks guests should complete before checkout.' }
    ];

    // Sample data
    const initialQRCodes = [
      { id: 'qr-001', title: 'WiFi Access', content: 'WIFI:T:WPA;S:BeachHouse;P:Welcome123;;', useCaseId: 'uc-001', useCaseName: 'WiFi Connection' },
      { id: 'qr-002', title: 'House Rules', content: 'https://splitlease.com/rules/hm-001', useCaseId: 'uc-002', useCaseName: 'House Rules' },
      { id: 'qr-003', title: 'Emergency Contacts', content: 'https://splitlease.com/emergency/hm-001', useCaseId: 'uc-003', useCaseName: 'Emergency Info' }
    ];

    // Toast Component
    function Toast({ toast, onClose }) {
      return (
        <div className={`toast toast-${toast.type}`}>
          <div className="toast-icon">{Icons[toast.type] || Icons.info}</div>
          <span className="toast-message">{toast.message}</span>
          <button className="toast-close" onClick={onClose}>{Icons.close}</button>
        </div>
      );
    }

    // QR Code Grid
    function QRCodeGrid({ qrCodes, selectedQRCodes, onEdit, onDelete, onToggleSelect, onAddNew }) {
      if (qrCodes.length === 0) {
        return (
          <div className="qr-grid-empty">
            <div className="empty-state">
              <div className="empty-icon">{Icons.qrcode}</div>
              <h3>No QR codes added...</h3>
              <p>Create your first QR code for this house manual</p>
              <button className="btn btn-primary" onClick={onAddNew}>
                {Icons.plus} Add QR Code
              </button>
            </div>
          </div>
        );
      }

      return (
        <div className="qr-grid">
          {qrCodes.map(qrCode => (
            <div key={qrCode.id} className={`qr-card ${selectedQRCodes.has(qrCode.id) ? 'selected' : ''}`}>
              <div className="qr-select" onClick={() => onToggleSelect(qrCode.id)}>
                <div className={`checkbox ${selectedQRCodes.has(qrCode.id) ? 'checked' : ''}`}>
                  {selectedQRCodes.has(qrCode.id) && Icons.check}
                </div>
              </div>
              <div className="qr-image" onClick={() => onToggleSelect(qrCode.id)}>
                <QRCodeCanvas value={qrCode.content} size={120} />
              </div>
              <div className="qr-info">
                <h4 className="qr-title">{qrCode.title}</h4>
                <span className="qr-usecase">{qrCode.useCaseName}</span>
              </div>
              <div className="qr-actions">
                <button className="btn-icon btn-edit" onClick={() => onEdit(qrCode)} title="Edit">{Icons.edit}</button>
                <button className="btn-icon btn-delete" onClick={() => onDelete(qrCode.id)} title="Delete">{Icons.delete}</button>
              </div>
            </div>
          ))}
          <div className="qr-card qr-card-add" onClick={onAddNew}>
            <div className="add-icon">
              <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="1.5"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg>
            </div>
            <span>Add QR Code</span>
          </div>
        </div>
      );
    }

    // QR Code Form
    function QRCodeForm({ qrCode, onSave, onCancel, isEditMode }) {
      const [title, setTitle] = useState(qrCode?.title || '');
      const [content, setContent] = useState(qrCode?.content || '');
      const [selectedUseCaseId, setSelectedUseCaseId] = useState(qrCode?.useCaseId || '');
      const [errors, setErrors] = useState({});

      const selectedUseCase = useCases.find(uc => uc.id === selectedUseCaseId);

      const validate = () => {
        const newErrors = {};
        if (!title.trim()) newErrors.title = 'Title is required';
        if (!content.trim()) newErrors.content = 'QR code content is required';
        else if (content.length > 2000) newErrors.content = 'Content must be less than 2000 characters';
        if (!selectedUseCaseId) newErrors.useCase = 'Please select a use case';
        setErrors(newErrors);
        return Object.keys(newErrors).length === 0;
      };

      const handleSubmit = (e) => {
        e.preventDefault();
        if (!validate()) return;
        const useCase = useCases.find(uc => uc.id === selectedUseCaseId);
        onSave({
          id: qrCode?.id || `qr-${Date.now()}`,
          title: title.trim(),
          content: content.trim(),
          useCaseId: selectedUseCaseId,
          useCaseName: useCase?.name || ''
        });
      };

      return (
        <div className="qr-form-container">
          <div className="qr-form-header">
            <h2>{isEditMode ? 'Edit QR Code' : 'Create a New QR Code'}</h2>
            <p>Fill in the details below to {isEditMode ? 'update' : 'generate'} your QR code</p>
          </div>
          <form className="qr-form" onSubmit={handleSubmit}>
            <div className="form-layout">
              <div className="form-fields">
                <div className="form-group">
                  <label>QR Code Title</label>
                  <input type="text" value={title} onChange={(e) => setTitle(e.target.value)} placeholder="Enter a descriptive title" className={errors.title ? 'error' : ''} />
                  {errors.title && <span className="error-message">{errors.title}</span>}
                </div>
                <div className="form-group">
                  <label>Select the type of instructions</label>
                  <select value={selectedUseCaseId} onChange={(e) => setSelectedUseCaseId(e.target.value)} className={errors.useCase ? 'error' : ''}>
                    <option value="">Choose a use case...</option>
                    {useCases.map(uc => <option key={uc.id} value={uc.id}>{uc.name}</option>)}
                  </select>
                  {errors.useCase && <span className="error-message">{errors.useCase}</span>}
                </div>
                {selectedUseCase && (
                  <div className="usecase-description">
                    {Icons.info}
                    <span>{selectedUseCase.description}</span>
                  </div>
                )}
                <div className="form-group">
                  <label>QR Code Content</label>
                  <textarea value={content} onChange={(e) => setContent(e.target.value)} placeholder="Enter the URL, text, or data to encode" rows={4} className={errors.content ? 'error' : ''} />
                  <div className="input-footer">
                    <span className="char-count">{content.length}/2000 characters</span>
                    {errors.content && <span className="error-message">{errors.content}</span>}
                  </div>
                </div>
              </div>
              <div className="qr-preview">
                <div className="preview-label">Preview</div>
                <div className="preview-box">
                  {content ? <QRCodeCanvas value={content} size={180} /> : (
                    <div className="preview-placeholder">
                      <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="1"><rect x="3" y="3" width="7" height="7"></rect><rect x="14" y="3" width="7" height="7"></rect><rect x="14" y="14" width="7" height="7"></rect><rect x="3" y="14" width="7" height="7"></rect></svg>
                      <span>Enter content to preview</span>
                    </div>
                  )}
                </div>
                {title && <div className="preview-title">{title}</div>}
              </div>
            </div>
            <div className="form-actions">
              <button type="button" className="btn btn-secondary" onClick={onCancel}>Cancel</button>
              <button type="submit" className="btn btn-primary">{isEditMode ? 'Save Changes' : 'Create QR Code'}</button>
            </div>
          </form>
        </div>
      );
    }

    // Print Preview
    function PrintPreview({ qrCodes, houseManualName, onPrint, onBack }) {
      return (
        <div className="print-preview">
          <div className="preview-header">
            <h2>Print Preview</h2>
            <p>{qrCodes.length} QR code{qrCodes.length !== 1 ? 's' : ''} selected for printing</p>
          </div>
          <div className="print-content">
            <div className="print-header">
              <h1>{houseManualName}</h1>
              <p>QR Codes for Guest Reference</p>
            </div>
            <div className="print-grid">
              {qrCodes.map(qrCode => (
                <div key={qrCode.id} className="print-qr-card">
                  <div className="print-qr-image">
                    <QRCodeCanvas value={qrCode.content} size={150} />
                  </div>
                  <div className="print-qr-info">
                    <h3>{qrCode.title}</h3>
                    <span className="print-usecase">{qrCode.useCaseName}</span>
                  </div>
                </div>
              ))}
            </div>
            <div className="print-footer">
              <p>Generated by Split Lease</p>
            </div>
          </div>
          <div className="preview-actions">
            <button className="btn btn-secondary" onClick={onBack}>{Icons.back} Back to Edit</button>
            <button className="btn btn-primary" onClick={onPrint}>{Icons.print} Print Now</button>
          </div>
        </div>
      );
    }

    // Main Dashboard
    function QRCodeDashboard() {
      const [qrCodes, setQRCodes] = useState(initialQRCodes);
      const [mode, setMode] = useState('view');
      const [qrCodeToEdit, setQrCodeToEdit] = useState(null);
      const [selectedQRCodes, setSelectedQRCodes] = useState(new Set());
      const [toasts, setToasts] = useState([]);

      const showToast = useCallback((type, message) => {
        const id = Date.now().toString();
        setToasts(prev => [...prev, { id, type, message }]);
        setTimeout(() => setToasts(prev => prev.filter(t => t.id !== id)), 3000);
      }, []);

      const handleAddQRCode = () => { setQrCodeToEdit(null); setMode('create'); };

      const handleEditQRCode = (qrCode) => { setQrCodeToEdit(qrCode); setMode('edit'); };

      const handleDeleteQRCode = (qrCodeId) => {
        if (window.confirm('Are you sure you want to delete this QR code?')) {
          setQRCodes(prev => prev.filter(q => q.id !== qrCodeId));
          setSelectedQRCodes(prev => { const updated = new Set(prev); updated.delete(qrCodeId); return updated; });
          showToast('success', 'QR Code deleted successfully');
        }
      };

      const handleSaveQRCode = (qrCode) => {
        setQRCodes(prev => {
          const idx = prev.findIndex(q => q.id === qrCode.id);
          if (idx >= 0) { const updated = [...prev]; updated[idx] = qrCode; return updated; }
          return [...prev, qrCode];
        });
        showToast('success', mode === 'create' ? 'QR Code created successfully' : 'QR Code updated successfully');
        setMode('view');
        setQrCodeToEdit(null);
      };

      const handleCancelForm = () => { setMode('view'); setQrCodeToEdit(null); };
      const handleBack = () => { if (mode === 'preview') setMode('view'); };

      const handleToggleSelect = (qrCodeId) => {
        setSelectedQRCodes(prev => {
          const updated = new Set(prev);
          if (updated.has(qrCodeId)) updated.delete(qrCodeId);
          else updated.add(qrCodeId);
          return updated;
        });
      };

      const handleSelectAll = () => {
        if (selectedQRCodes.size === qrCodes.length) setSelectedQRCodes(new Set());
        else setSelectedQRCodes(new Set(qrCodes.map(q => q.id)));
      };

      const handlePreview = () => {
        if (selectedQRCodes.size === 0) { showToast('warning', 'Please select at least one QR code to preview'); return; }
        setMode('preview');
      };

      const handlePrint = () => {
        if (selectedQRCodes.size === 0) { showToast('warning', 'Please select at least one QR code to print'); return; }
        window.print();
      };

      const selectedQRCodesArray = qrCodes.filter(q => selectedQRCodes.has(q.id));

      return (
        <div className="qr-dashboard">
          <div className="toast-container">
            {toasts.map(toast => <Toast key={toast.id} toast={toast} onClose={() => setToasts(prev => prev.filter(t => t.id !== toast.id))} />)}
          </div>

          <div className="dashboard-header">
            <div className="header-left">
              <h1 className="dashboard-title">QR Codes</h1>
              <span className="qr-count">{qrCodes.length} codes</span>
            </div>
            <div className="header-right">
              {mode === 'view' && selectedQRCodes.size > 0 && <span className="selected-count">{selectedQRCodes.size} selected</span>}
            </div>
          </div>

          <div className="dashboard-actions">
            <div className="actions-left">
              {mode !== 'view' && <button className="btn btn-secondary" onClick={handleBack}>{Icons.back} Back</button>}
              {mode === 'view' && <button className="btn btn-primary" onClick={handleAddQRCode}>{Icons.plus} Add QR Code</button>}
            </div>
            {mode === 'view' && qrCodes.length > 0 && (
              <div className="actions-right">
                <button className="btn btn-outline" onClick={handleSelectAll}>
                  {selectedQRCodes.size === qrCodes.length ? 'Deselect All' : 'Select All'}
                </button>
                <button className="btn btn-outline" onClick={handlePreview} disabled={selectedQRCodes.size === 0}>
                  {Icons.eye} Preview
                </button>
                <button className="btn btn-primary" onClick={handlePrint} disabled={selectedQRCodes.size === 0}>
                  {Icons.print} Print ({selectedQRCodes.size})
                </button>
              </div>
            )}
          </div>

          <div className="dashboard-content">
            {mode === 'view' && (
              <QRCodeGrid
                qrCodes={qrCodes}
                selectedQRCodes={selectedQRCodes}
                onEdit={handleEditQRCode}
                onDelete={handleDeleteQRCode}
                onToggleSelect={handleToggleSelect}
                onAddNew={handleAddQRCode}
              />
            )}
            {(mode === 'create' || mode === 'edit') && (
              <QRCodeForm
                qrCode={qrCodeToEdit}
                onSave={handleSaveQRCode}
                onCancel={handleCancelForm}
                isEditMode={mode === 'edit'}
              />
            )}
            {mode === 'preview' && (
              <PrintPreview
                qrCodes={selectedQRCodesArray}
                houseManualName="Beach House Manual"
                onPrint={handlePrint}
                onBack={() => setMode('view')}
              />
            )}
          </div>
        </div>
      );
    }

    // Render
    ReactDOM.createRoot(document.getElementById('root')).render(<QRCodeDashboard />);
  </script>
</body>
</html>
